import{u as L,h as M,p as q,i as B,j as e,C as l,f as r,g as n,T as j,d as c,Z as p,e as g,S as f,m as Q,B as x}from"./index-DCOvJKlU.js";import{P as F}from"./progress-m_owvb2C.js";import{T as K,a as O,b as N,c as b}from"./tabs-WuRWSCi2.js";import{S as v}from"./star-_cW8yoXg.js";import{C as y}from"./crown-Cy8OV6YG.js";function J(){const{toast:m}=L(),w=M(),{data:a,isLoading:P}=q({queryKey:["/api/skills"]}),C=B({mutationFn:async({skillId:s,enhancement:t})=>{const o=await fetch(`/api/skills/${s}/use-talent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enhancement:t})});if(!o.ok){const E=await o.json();throw new Error(E.message||"天赋使用失败")}return o.json()},onSuccess:()=>{w.invalidateQueries({queryKey:["/api/skills"]}),m({title:"天赋使用成功",description:"技能已获得增强效果"})},onError:s=>{m({title:"天赋使用失败",description:s.message,variant:"destructive"})}}),i=(s,t)=>{C.mutate({skillId:s,enhancement:t})},T=s=>s>=3?e.jsx(y,{className:"w-4 h-4 text-purple-500"}):s>=2?e.jsx(j,{className:"w-4 h-4 text-gold-500"}):s>=1?e.jsx(v,{className:"w-4 h-4 text-blue-500"}):null;if(P)return e.jsx("div",{className:"container mx-auto p-6",children:e.jsx("div",{className:"text-center",children:"加载中..."})});const d=a||[],u=d.reduce((s,t)=>s+(t.level-1),0),S=d.reduce((s,t)=>s+t.exp,0),h=d.reduce((s,t)=>s+(t.talentPoints||0),0);return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"核心技能"}),e.jsx("p",{className:"text-muted-foreground",children:"六大核心能力发展"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"总等级"}),e.jsx(j,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["平均等级: ",a&&a.length>0?(u/a.length+1).toFixed(1):0]})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"总经验值"}),e.jsx(p,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:S.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"已获得经验"})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"天赋点数"}),e.jsx(v,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"可用天赋点"})]})]})]}),e.jsxs(K,{defaultValue:"skills",className:"space-y-4",children:[e.jsxs(O,{className:"grid w-full grid-cols-2",children:[e.jsx(N,{value:"skills",children:"核心技能"}),e.jsx(N,{value:"talents",children:"天赋增强"})]}),e.jsx(b,{value:"skills",className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(s=>{const t=Math.max(0,Math.min(100,s.exp/s.maxExp*100));return e.jsxs(l,{className:"relative overflow-hidden transition-all duration-200 hover:shadow-lg border-2",style:{borderColor:s.color},children:[e.jsx(r,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:s.color+"20"},children:e.jsx("i",{className:`${s.icon} text-xl`,style:{color:s.color}})}),e.jsxs("div",{children:[e.jsx(n,{className:"text-lg font-bold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(g,{variant:"secondary",className:"text-sm",children:["Lv.",s.level]}),s.prestige&&s.prestige>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[T(s.prestige),e.jsx("span",{className:"text-xs font-medium",children:s.prestige})]})]})]})]})})}),e.jsx(c,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"经验值"}),e.jsxs("span",{children:[s.exp,"/",s.maxExp]})]}),e.jsx(F,{value:t,className:"h-3"}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[Math.floor(t),"% 至下一级"]}),s.talentPoints&&s.talentPoints>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-accent/10 rounded-lg p-2",children:[e.jsx(f,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("span",{children:["天赋点: ",s.talentPoints]})]})]})})]},s.id)})})}),e.jsx(b,{value:"talents",className:"space-y-4",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(f,{className:"w-6 h-6"}),e.jsx("h3",{className:"text-xl font-semibold",children:"天赋系统"})]}),e.jsxs("p",{className:"text-muted-foreground",children:["总天赋点: ",h]}),e.jsxs("div",{className:"bg-card border-border rounded-2xl p-6",children:[e.jsx("h4",{className:"font-medium text-center mb-6 text-xl text-foreground",children:"天赋增强选项"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800/30 rounded-xl p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:e.jsx(p,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:"经验加成 (1点)"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:"下次任务经验+20%"})]})]})}),e.jsx("div",{className:"bg-purple-50 dark:bg-purple-950/20 border border-purple-200 dark:border-purple-800/30 rounded-xl p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-purple-900 dark:text-purple-100",children:"等级加速 (3点)"}),e.jsx("p",{className:"text-sm text-purple-700 dark:text-purple-300 mt-1",children:"技能直接获得100经验值"})]})]})}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800/30 rounded-xl p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 dark:bg-yellow-900/30 rounded-full flex items-center justify-center",children:e.jsx(y,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-900 dark:text-yellow-100",children:"声望提升 (5点)"}),e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"技能声望等级+1"})]})]})})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.filter(s=>s.talentPoints&&s.talentPoints>0).map(s=>e.jsxs(l,{className:"border-2",style:{borderColor:s.color},children:[e.jsx(r,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx("i",{className:s.icon,style:{color:s.color}}),s.name,e.jsxs(g,{variant:"secondary",children:[s.talentPoints," 天赋点"]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{onClick:()=>i(s.id,"experience"),disabled:!s.talentPoints||s.talentPoints<1,className:"w-full",variant:"outline",children:"经验加成 (1点)"}),e.jsx(x,{onClick:()=>i(s.id,"level"),disabled:!s.talentPoints||s.talentPoints<3,className:"w-full",variant:"outline",children:"等级加速 (3点)"}),e.jsx(x,{onClick:()=>i(s.id,"prestige"),disabled:!s.talentPoints||s.talentPoints<5,className:"w-full",variant:"outline",children:"声望提升 (5点)"})]})})]},s.id))}),a.filter(s=>s.talentPoints&&s.talentPoints>0).length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:["暂无可用天赋点的技能",e.jsx("br",{}),"完成任务升级技能即可获得天赋点"]})]})})]})]})}export{J as default};
