import{q as F,r as h,h as fe,p as U,u as he,i as V,j as e,C as z,d as G,f as Pe,g as Se,P as De,I as Ee,B as c,o as y,m as Z,e as u,D as pe,a as ge,b as be,c as ye,k as je,s as Ne,Z as W,X as Ie,l as ve,t as oe}from"./index-DCOvJKlU.js";import{P as de}from"./progress-m_owvb2C.js";import{T as qe,a as Me,b as ee,c as se}from"./tabs-WuRWSCi2.js";import{C as we}from"./clock-Q4wC7def.js";import{C as te}from"./crown-Cy8OV6YG.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=F("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=F("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=F("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=F("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=F("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=F("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),$e={goal:{name:"ÁõÆÊ†á",icon:"üéØ",color:"blue",description:"ÈïøÊúü‰∏ªÁ∫øÁõÆÊ†á‰ªªÂä°"},todo:{name:"ÂæÖÂäû",icon:"‚úÖ",color:"purple",description:"‰∏ÄÊ¨°ÊÄß‰ªªÂä°ÔºåÂÆåÊàêÂêéÊ∂àÈô§"},habit:{name:"‰π†ÊÉØ",icon:"üîÑ",color:"green",description:"ÂèØÈáçÂ§çÂÆåÊàêÔºåÂª∫Á´ãÈïøÊúü‰π†ÊÉØ"}},ae={trivial:{name:"ÂæÆ‰∏çË∂≥ÈÅì",xp:1,gold:1,color:"gray"},easy:{name:"ÁÆÄÂçï",xp:5,gold:2,color:"green"},medium:{name:"‰∏≠Á≠â",xp:10,gold:5,color:"yellow"},hard:{name:"Âõ∞Èöæ",xp:15,gold:8,color:"red"}},Le=(i,g)=>{const m=i/g*100;return m>=80?"Á≤æÂäõÂÖÖÊ≤õÔºåÂèØ‰ª•ÊåëÊàò‰ªª‰Ωï‰ªªÂä°ÔºÅ":m>=60?"Áä∂ÊÄÅËâØÂ•ΩÔºåÈÄÇÂêà‰∏≠Á≠âÂº∫Â∫¶‰ªªÂä°":m>=40?"Á®çÊúâÁñ≤ÊÉ´ÔºåÂª∫ËÆÆÂÅöÁÆÄÂçï‰ªªÂä°":m>=20?"ËÉΩÈáè‰∏çË∂≥ÔºåÈúÄË¶ÅÈÄÇÂΩì‰ºëÊÅØ":m>0?"ÊûÅÂ∫¶Áñ≤ÊÉ´ÔºåÂº∫ÁÉàÂª∫ËÆÆ‰ºëÊÅØ":"ËÉΩÈáèËÄóÂ∞ΩÔºåÂøÖÈ°ª‰ºëÊÅØÊÅ¢Â§ç"};function Y({task:i,onComplete:g,onDelete:m,onStartPomodoro:E,pomodoroState:p,onPausePomodoro:$,onResumePomodoro:T,onResetPomodoro:t,formatTime:B,userStats:I,skills:j,getIconEmoji:r=d=>"‚≠ê"}){const d=$e[i.taskCategory],N=ae[i.difficulty],R=(p==null?void 0:p.taskId)===i.id,P=i.taskCategory==="todo"&&!i.completed,v=i.requiredEnergyBalls||1,n=!I||I.energyBalls>=v,O=i.completed||n;return e.jsx(z,{className:"bg-card border-border hover:shadow-md transition-all",children:e.jsxs(G,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(c,{size:"sm",variant:"ghost",onClick:()=>g(i.id),disabled:!O,className:`mt-1 h-10 w-10 p-0 rounded-full touch-manipulation ${i.completed?"text-green-600 bg-green-100":O?"text-muted-foreground hover:text-green-600 hover:bg-green-100":"text-gray-400 bg-gray-100 cursor-not-allowed opacity-50"}`,children:i.completed?e.jsx(ve,{className:"h-5 w-5"}):e.jsx(Ne,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx("h3",{className:`font-semibold text-base leading-tight ${i.completed?"line-through text-muted-foreground":"text-foreground"}`,children:i.title}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsxs(u,{variant:"outline",className:"text-primary border-primary/30 text-xs px-2 py-1",children:[d.icon," ",d.name]}),!i.completed&&i.taskCategory==="goal"&&e.jsx(Ce,{taskId:i.id}),e.jsx(c,{size:"sm",variant:"ghost",onClick:()=>m(i.id),className:"text-destructive hover:text-destructive hover:bg-destructive/10 h-8 w-8 p-0 rounded-lg touch-manipulation",children:e.jsx(Qe,{className:"h-4 w-4"})})]})]}),i.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-3 leading-relaxed",children:i.description}),i.skillId&&j&&e.jsxs("div",{className:"flex items-center gap-2 mb-4 p-2 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-lg border border-purple-200/50 dark:border-purple-700/50",children:[e.jsx(oe,{className:"h-4 w-4 text-purple-600 dark:text-purple-400 flex-shrink-0"}),e.jsx("div",{className:"flex-1",children:(()=>{const w=j.find(q=>q.id===i.skillId);return w?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs font-medium text-purple-700 dark:text-purple-300",children:[r(w.icon)," ",w.name]}),e.jsxs("span",{className:"text-xs text-purple-600 dark:text-purple-400",children:["Lv.",w.level]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-purple-600 dark:text-purple-400",children:[e.jsx(W,{className:"h-3 w-3"}),e.jsxs("span",{children:["+",i.expReward||20," XP"]})]})]}):null})()})]}),!i.skillId&&i.tags&&i.tags.length>0&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-4",children:[e.jsx(oe,{className:"h-4 w-4 text-secondary flex-shrink-0"}),i.tags.map((w,q)=>e.jsx(u,{variant:"outline",className:"text-xs text-secondary border-secondary/30 bg-secondary/10",children:w},q))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 py-3 border-t border-border",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-medium text-sm",children:["+",i.expReward||N.xp," XP"]})]}),e.jsxs("div",{className:`flex items-center gap-1 ${n?"text-accent":"text-red-500"}`,children:[Array.from({length:v}).map((w,q)=>e.jsx("span",{className:"text-sm",children:"üîµ"},q)),e.jsxs("span",{className:"font-medium text-sm ml-1",children:[v*15,"ÂàÜÈíü"]}),!n&&e.jsx("span",{className:"text-xs text-red-500 ml-1",children:"(ËÉΩÈáè‰∏çË∂≥)"})]}),i.taskCategory==="habit"&&(i.habitStreak||0)>0&&e.jsxs("div",{className:"flex items-center gap-2 text-secondary",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-medium text-sm",children:[i.habitStreak,"ËøûÂáª"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.taskCategory==="habit"&&e.jsx(u,{variant:"outline",className:"bg-secondary/20 text-secondary border-secondary/30 text-xs px-2 py-1",children:"üîÑ ÊØèÊó•‰π†ÊÉØ"}),e.jsx(u,{variant:"secondary",className:"text-xs px-2 py-1",children:N.name})]})]}),P&&!R&&e.jsx("div",{className:"pt-3 mt-3 border-t border-border",children:e.jsx(c,{size:"sm",onClick:()=>E==null?void 0:E(i.id),className:"w-full h-11 bg-gradient-to-r from-blue-700 to-blue-600 hover:from-blue-800 hover:to-blue-700 text-white border-0 transition-all touch-manipulation shadow-md",style:{backgroundColor:"#1d4ed8"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-base",children:"‚öîÔ∏è"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-bold",style:{color:"#ffffff",textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:"ÊåëÊàòBoss"}),e.jsx("div",{className:"text-xs font-medium",style:{color:"#dbeafe",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},children:"25ÂàÜÈíü‰∏ìÊ≥®ÊàòÊñó"})]})]})})})]})})}function Ke(){var re,ie,le,ne;const[i,g]=h.useState({title:"",description:"",category:"todo",difficulty:"medium"}),[m,E]=h.useState("goal"),[p,$]=h.useState(!1),T=s=>({"fas fa-target":"üéØ","fas fa-star":"‚≠ê","fas fa-book-open":"üìñ","fas fa-glasses":"üëì","fas fa-brain":"üß†","fas fa-lightbulb":"üí°","fas fa-search":"üîç","fas fa-flask":"üß™","fas fa-chart-line":"üìà","fas fa-microscope":"üî¨","fas fa-edit":"‚úèÔ∏è","fas fa-pen":"üñäÔ∏è","fas fa-file-alt":"üìÑ","fas fa-book":"üìö","fas fa-palette":"üé®","fas fa-paint-brush":"üñåÔ∏è","fas fa-magic":"‚ú®","fas fa-image":"üñºÔ∏è","fas fa-code":"üíª","fas fa-laptop":"üíª","fas fa-bug":"üêõ","fas fa-cogs":"‚öôÔ∏è","fas fa-users":"üë•","fas fa-crown":"üëë","fas fa-calendar":"üìÖ","fas fa-clipboard":"üìã","fas fa-comments":"üí¨","fas fa-microphone":"üé§","fas fa-heart":"‚ù§Ô∏è","fas fa-handshake":"ü§ù","fas fa-graduation-cap":"üéì","fas fa-university":"üèõÔ∏è","fas fa-atom":"‚öõÔ∏è","fas fa-tools":"üîß"})[s]||"‚≠ê",[t,B]=h.useState({taskId:null,isRunning:!1,timeLeft:25*60,totalTime:25*60,isBreak:!1}),[I,j]=h.useState(!1),r=fe(),{data:d=[],isLoading:N}=U({queryKey:["/api/tasks"]}),{data:R=[]}=U({queryKey:["/api/skills"]}),{toast:P}=he(),{data:v=[]}=U({queryKey:["/api/goals"]}),{data:n}=U({queryKey:["/api/user-stats"]}),O=V({mutationFn:async()=>y("POST","/api/tasks/reset-daily-habits"),onSuccess:()=>{r.invalidateQueries({queryKey:["/api/tasks"]}),r.invalidateQueries({queryKey:["/api/user-stats"]}),r.invalidateQueries({queryKey:["/api/profile"]})},onError:s=>{console.error("Silent habit reset failed:",s)}});h.useEffect(()=>{const s=localStorage.getItem("lastHabitReset"),a=new Date().toDateString();s!==a&&(O.mutate(),localStorage.setItem("lastHabitReset",a))},[O]),V({mutationFn:async s=>{const a=ae[s.difficulty];return y("POST","/api/tasks",{...s,expReward:a.xp,requiredEnergyBalls:Math.ceil((s.estimatedDuration||25)/15),taskCategory:s.taskCategory||"todo"})},onMutate:async s=>{await r.cancelQueries({queryKey:["/api/tasks"]});const a=r.getQueryData(["/api/tasks"]),l=ae[s.difficulty],o={id:Date.now(),userId:"temp",title:s.title,description:s.description||null,completed:!1,taskCategory:s.taskCategory||"todo",difficulty:s.difficulty,expReward:l.xp,requiredEnergyBalls:Math.ceil((s.estimatedDuration||25)/15),estimatedDuration:s.estimatedDuration||25,createdAt:new Date,completedAt:null,skillId:null,order:0,tags:[],skills:[],habitStreak:0,habitValue:0};return r.setQueryData(["/api/tasks"],x=>x?[...x,o]:[o]),g({title:"",description:"",category:"todo",difficulty:"medium"}),{previousTasks:a}},onError:(s,a,l)=>{l!=null&&l.previousTasks&&r.setQueryData(["/api/tasks"],l.previousTasks),g({title:a.title,description:a.description||"",category:a.taskCategory||"todo",difficulty:a.difficulty||"medium"})},onSettled:()=>{r.invalidateQueries({queryKey:["/api/tasks"]})}});const w=V({mutationFn:async({id:s,updates:a})=>y("PATCH",`/api/tasks/${s}`,a),onMutate:async({id:s,updates:a})=>{await r.cancelQueries({queryKey:["/api/tasks"]}),await r.cancelQueries({queryKey:["/api/user-stats"]});const l=r.getQueryData(["/api/tasks"]),o=r.getQueryData(["/api/user-stats"]);return r.setQueryData(["/api/tasks"],x=>x?x.map(k=>k.id===s?{...k,...a}:k):[]),{previousTasks:l,previousStats:o}},onError:(s,{id:a,updates:l},o)=>{o!=null&&o.previousTasks&&r.setQueryData(["/api/tasks"],o.previousTasks),o!=null&&o.previousStats&&r.setQueryData(["/api/user-stats"],o.previousStats)},onSuccess:(s,{id:a,updates:l})=>{if(l.completed){const o=d.find(x=>x.id===a);if(o){const x=o.requiredEnergyBalls||1;P({title:"‰ªªÂä°ÂÆåÊàêÔºÅ",description:`Ëé∑Âæó ${o.expReward||20} ÁªèÈ™åÂÄºÔºåÊ∂àËÄó ${x} ‰∏™ËÉΩÈáèÁêÉ`})}}},onSettled:()=>{r.invalidateQueries({queryKey:["/api/tasks"]}),r.invalidateQueries({queryKey:["/api/user-stats"]})}}),q=V({mutationFn:async s=>y("DELETE",`/api/tasks/${s}`),onMutate:async s=>{await r.cancelQueries({queryKey:["/api/tasks"]});const a=r.getQueryData(["/api/tasks"]);return r.setQueryData(["/api/tasks"],l=>l?l.filter(o=>o.id!==s):[]),{previousTasks:a}},onError:(s,a,l)=>{l!=null&&l.previousTasks&&r.setQueryData(["/api/tasks"],l.previousTasks)},onSettled:()=>{r.invalidateQueries({queryKey:["/api/tasks"]})}}),L=s=>{const a=d.find(l=>l.id===s);if(a){if(!a.completed&&n){const l=a.requiredEnergyBalls||1;if(n.energyBalls<l){P({title:"ËÉΩÈáè‰∏çË∂≥",description:`ÂÆåÊàêÊ≠§‰ªªÂä°ÈúÄË¶Å ${l} ‰∏™ËÉΩÈáèÁêÉÔºå‰ΩÜÊÇ®Âè™Êúâ ${n.energyBalls} ‰∏™`,variant:"destructive"});return}}w.mutate({id:s,updates:{completed:!a.completed,completedAt:a.completed?null:new Date}})}},_=s=>{q.mutate(s)};V({mutationFn:async()=>y("POST","/api/tasks/reset-daily-habits"),onSuccess:s=>{P({title:"ÊØèÊó•ÈáçÁΩÆÂÆåÊàê",description:s.energyBallsRestored?`Â∑≤ÈáçÁΩÆ ${s.resetCount} ‰∏™‰π†ÊÉØ‰ªªÂä°ÔºåËÉΩÈáèÁêÉÂ∑≤ÊÅ¢Â§ç`:`Â∑≤ÈáçÁΩÆ ${s.resetCount} ‰∏™‰π†ÊÉØ‰ªªÂä°`}),r.invalidateQueries({queryKey:["/api/tasks"]}),r.invalidateQueries({queryKey:["/api/user-stats"]}),r.invalidateQueries({queryKey:["/api/profile"]})},onError:()=>{P({title:"ÈáçÁΩÆÂ§±Ë¥•",description:"ÊØèÊó•ÈáçÁΩÆÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï",variant:"destructive"})}});const b=h.useRef(null),H=h.useRef(0);h.useEffect(()=>{if(!t.isRunning){b.current=null;return}b.current||(b.current=Date.now(),H.current=t.totalTime-t.timeLeft);const a=setInterval(()=>{if(!b.current)return;const l=Date.now(),o=Math.floor((l-b.current)/1e3),x=H.current+o,k=Math.max(0,t.totalTime-x);B(f=>k!==f.timeLeft?k<=0&&f.timeLeft>0?(!f.isBreak&&f.taskId&&(v.some(C=>C.id===f.taskId)&&y("POST",`/api/goals/${f.taskId}/pomodoro-complete`).then(C=>{console.log("üéâ ‰∏ªÁ∫ø‰ªªÂä°Áï™ËåÑÈíüÂÆåÊàêÔºÅ",C),C.expGained&&C.goldGained&&console.log(`üíé Ëé∑ÂæóÂ•ñÂä±: +${C.expGained} EXP, +${C.goldGained} ÈáëÂ∏Å`),r.invalidateQueries({queryKey:["/api/user-stats"]}),r.invalidateQueries({queryKey:["/api/skills"]})}).catch(C=>console.error("ÂèëÊîæÁõÆÊ†áÁï™ËåÑÈíüÂ•ñÂä±Â§±Ë¥•:",C)),console.log("üëë ÊÅ≠ÂñúÔºÅÊàêÂäüÂáªË¥•BossÔºÅËé∑ÂæóÈ¢ùÂ§ñÁªèÈ™åÂÄºÂíåÊàòÂà©ÂìÅÔºÅ")),b.current=null,H.current=0,{...f,isRunning:!1,isBreak:!f.isBreak,timeLeft:f.isBreak?25*60:5*60,totalTime:f.isBreak?25*60:5*60}):{...f,timeLeft:k}:f)},100);return()=>clearInterval(a)},[t.isRunning,t.totalTime,v,r]);const X=s=>{B({taskId:s,isRunning:!0,timeLeft:25*60,totalTime:25*60,isBreak:!1}),j(!0)},K=()=>{if(b.current){const s=Date.now(),a=Math.floor((s-b.current)/1e3);H.current+=a,b.current=null}B(s=>({...s,isRunning:!1}))},A=()=>{B(s=>({...s,isRunning:!0}))},Te=()=>{j(!1)},M=()=>{b.current=null,H.current=0,B({taskId:null,isRunning:!1,timeLeft:25*60,totalTime:25*60,isBreak:!1}),j(!1)},Q=s=>{const a=Math.floor(s/60),l=s%60;return`${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},Be=s=>{const a=new Date,l=a.toDateString();return s.filter(o=>{const x=new Date(o.createdAt),k=x.toDateString();return o.taskCategory==="habit"||k===l||x<a&&!o.completed})},J=s=>{const a=Be(d);return!s||s==="all"?a:a.filter(l=>l.taskCategory===s)},S=J("habit").map(s=>{const a=new Date().toDateString(),l=s.lastCompletedDate?new Date(s.lastCompletedDate).toDateString():null;return s.completed&&l!==a?{...s,completed:!1}:s}),D=J("todo"),Re=J("all").filter(s=>s.completed&&s.completedAt&&new Date(s.completedAt).toDateString()===new Date().toDateString());return N?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-background space-y-3 md:space-y-6 px-4 md:px-6 py-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"text-xl md:text-2xl",children:"‚öîÔ∏è"}),"RPG‰ªªÂä°ÂÜíÈô©"]}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"ÂÆåÊàê‰ªªÂä°Ëé∑ÂæóÁªèÈ™åÂÄºÔºåÂüπÂÖªÁßØÊûÅ‰π†ÊÉØÔºå‰øùÊåÅÊØèÊó•ËøûÂáªÔºÅ"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-6 md:gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl md:text-lg font-bold text-green-600",children:Re.length}),e.jsx("div",{className:"text-sm md:text-xs text-muted-foreground",children:"‰ªäÊó•ÂÆåÊàê"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl md:text-lg font-bold text-primary",children:d.filter(s=>!s.completed).length}),e.jsx("div",{className:"text-sm md:text-xs text-muted-foreground",children:"ÂæÖÂÆåÊàê"})]})]})]}),n&&e.jsx(z,{className:`transition-all duration-200 ${n.energyBalls<=3?"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-950/30 dark:to-red-900/20 border-red-200 dark:border-red-700 shadow-red-100":n.energyBalls<=8?"bg-gradient-to-br from-amber-50 to-yellow-100 dark:from-amber-950/30 dark:to-yellow-900/20 border-amber-200 dark:border-amber-700 shadow-amber-100":"bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-950/30 dark:to-indigo-900/20 border-blue-200 dark:border-blue-700 shadow-blue-100"} shadow-lg`,children:e.jsx(G,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-full ${n.energyBalls<=3?"bg-red-100 dark:bg-red-900/30":n.energyBalls<=8?"bg-amber-100 dark:bg-amber-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:e.jsx(ce,{className:`h-6 w-6 ${n.energyBalls<=3?"text-red-600 dark:text-red-400":n.energyBalls<=8?"text-amber-600 dark:text-amber-400":"text-blue-600 dark:text-blue-400"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-foreground mb-1",children:"ËÉΩÈáèÁä∂ÊÄÅ"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:Le(n.energyBalls,n.maxEnergyBalls)})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap max-w-[300px]",children:[Array.from({length:n.energyBalls}).map((s,a)=>e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm transition-all duration-200 hover:scale-110 ${n.energyBalls<=3?"bg-red-500 shadow-red-300":n.energyBalls<=8?"bg-amber-500 shadow-amber-300":"bg-blue-500 shadow-blue-300"} shadow-md`,children:"‚ö°"},a)),Array.from({length:n.maxEnergyBalls-n.energyBalls}).map((s,a)=>e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-dashed border-gray-300 dark:border-gray-600 opacity-50"},`empty-${a}`))]}),e.jsxs("div",{className:"text-center min-w-[80px]",children:[e.jsx("div",{className:`text-3xl font-bold mb-1 ${n.energyBalls<=3?"text-red-600 dark:text-red-400":n.energyBalls<=8?"text-amber-600 dark:text-amber-400":"text-blue-600 dark:text-blue-400"}`,children:n.energyBalls}),e.jsxs("div",{className:"text-sm text-muted-foreground font-medium",children:["/",n.maxEnergyBalls]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[n.energyBalls*15,"ÂàÜÈíüÂèØÁî®"]}),n.energyBalls===0&&e.jsx("div",{className:"text-xs text-red-500 font-medium mt-2 bg-red-100 dark:bg-red-900/30 px-2 py-1 rounded-full",children:"ÈúÄË¶Å‰ºëÊÅØÊÅ¢Â§ç"})]})]})]})})}),e.jsxs(z,{className:"bg-card border-border",children:[e.jsx(Pe,{className:"pb-3 px-4 pt-4",children:e.jsxs(Se,{className:"flex items-center gap-2 text-foreground text-base",children:[e.jsx(De,{className:"h-4 w-4"}),"AI Êô∫ËÉΩÂàõÂª∫"]})}),e.jsxs(G,{className:"space-y-3 px-4 pb-4",children:[e.jsx(Ee,{placeholder:"ËæìÂÖ•‰ªªÂä°ÊèèËø∞",value:i.title,onChange:s=>g(a=>({...a,title:s.target.value})),className:"bg-background border-border text-foreground h-10 text-sm px-3"}),e.jsx(c,{onClick:async()=>{if(!(!i.title.trim()||p)){$(!0);try{await y("POST","/api/tasks/intelligent-create",{description:i.title}),r.invalidateQueries({queryKey:["/api/tasks"]}),g({title:"",description:"",category:"todo",difficulty:"medium"}),P({title:"‰ªªÂä°ÂàõÂª∫ÊàêÂäü",description:"AIÂ∑≤‰∏∫ÊÇ®ÂàõÂª∫‰ªªÂä°"})}catch(s){console.error("‰ªªÂä°ÂàõÂª∫Â§±Ë¥•:",s),P({title:"ÂàõÂª∫Â§±Ë¥•",description:"‰ªªÂä°ÂàõÂª∫Â§±Ë¥•ÔºåËØ∑ÈáçËØï",variant:"destructive"})}finally{$(!1)}}},disabled:!i.title.trim()||p,className:"w-full h-10 bg-purple-700 hover:bg-purple-800 text-sm font-medium text-white border-0 disabled:opacity-50",style:{backgroundColor:"#7c3aed",color:"#ffffff",fontWeight:"600",border:"none"},children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"ÂàõÂª∫‰∏≠..."]}):"AI Êô∫ËÉΩÂàõÂª∫"}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:"AI Â∞ÜËá™Âä®ËØÜÂà´‰ªªÂä°Á±ªÂûãÔºà‰π†ÊÉØ vs ÊîØÁ∫ø‰ªªÂä°Ôºâ"})]})]}),e.jsx("div",{children:e.jsxs(qe,{value:m,onValueChange:E,children:[e.jsxs(Me,{className:"grid w-full grid-cols-3 bg-muted h-12",children:[e.jsxs(ee,{value:"goal",className:"data-[state=active]:bg-background text-xs py-3",children:["‰∏ªÁ∫ø‰ªªÂä° (",v.length,")"]}),e.jsxs(ee,{value:"todo",className:"data-[state=active]:bg-background text-xs py-3",children:["ÊîØÁ∫ø‰ªªÂä° (",D.filter(s=>!s.completed).length,")"]}),e.jsxs(ee,{value:"habit",className:"data-[state=active]:bg-background text-xs py-3",children:["‰π†ÊÉØ (",S.filter(s=>!s.completed).length,")"]})]}),e.jsxs(se,{value:"goal",className:"space-y-3",children:[e.jsxs("div",{className:"mb-4 p-4 bg-primary/10 rounded-lg border border-primary/30",children:[e.jsx("h3",{className:"font-medium text-primary mb-2",children:"üéØ ‰∏ªÁ∫ø‰ªªÂä° (Main Quests)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ÈïøÊúü‰∏ªÁ∫øÁõÆÊ†á‰ªªÂä°"})]}),v.length===0?e.jsx(z,{className:"bg-card border-border",children:e.jsxs(G,{className:"p-8 text-center",children:[e.jsx(Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"ÊöÇÊó†ÁõÆÊ†á"}),e.jsx("p",{className:"text-muted-foreground",children:"ÂâçÂæÄÁõÆÊ†áÈ°µÈù¢ÂàõÂª∫ÊÇ®ÁöÑÁ¨¨‰∏Ä‰∏™ÁõÆÊ†áÔºÅ"})]})}):v.map(s=>e.jsx(z,{className:"bg-card border-border hover:shadow-md transition-all",children:e.jsx(G,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-foreground mb-2",children:s.title}),e.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:s.description}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"ÊÄª‰ΩìËøõÂ∫¶"}),e.jsxs("span",{className:"text-primary",children:[Math.round((s.progress||0)*100),"%"]})]}),e.jsx(de,{value:(s.progress||0)*100,className:"h-2"})]}),(s.pomodoroExpReward||s.pomodoroGoldReward)&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(we,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-foreground",children:"Áï™ËåÑÈíüÂ•ñÂä±:"}),s.pomodoroExpReward&&e.jsxs(u,{className:"bg-primary text-primary-foreground text-xs",children:["+",s.pomodoroExpReward," EXP"]}),s.pomodoroGoldReward&&e.jsxs(u,{className:"bg-accent text-accent-foreground text-xs",children:["+",s.pomodoroGoldReward," ÈáëÂ∏Å"]})]})}),s.milestones&&s.milestones.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"ÈáåÁ®ãÁ¢ëÊÄªÊï∞"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:"outline",className:"text-xs",children:[s.milestones.length," ÈáåÁ®ãÁ¢ëÊÄªÊï∞"]}),e.jsxs(u,{variant:"outline",className:"text-xs text-accent",children:[s.milestones.filter(a=>a.completed).length," Â∑≤ÂÆåÊàê"]}),e.jsxs(u,{variant:"outline",className:"text-xs text-primary",children:[s.milestones.filter(a=>!a.completed).length," ÂæÖÂÆåÊàê"]})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ke,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"ÁÉ≠Ë∫´ÂáÜÂ§á"})]}),e.jsx(Ce,{taskId:s.id})]}),e.jsxs("div",{className:"bg-gradient-to-br from-accent/10 to-primary/10 rounded-lg p-3 border border-accent/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(te,{className:"h-4 w-4 text-accent"}),e.jsx("span",{className:"text-accent font-medium text-sm",children:"‰∏ªÁ∫ø‰ªªÂä°‰∏ìÊ≥®"}),e.jsx(u,{className:"bg-accent/20 text-accent text-xs",children:"Â¢ûÂº∫Â•ñÂä±"})]}),t.taskId===s.id?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-muted rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-xl",children:t.isBreak?"‚òï":(()=>{const a=(t.totalTime-t.timeLeft)/t.totalTime*100;return a<25?"‚öîÔ∏è":a<50?"üõ°Ô∏è":a<75?"üíé":"üëë"})()}),e.jsx("div",{children:e.jsx("div",{className:"text-sm font-medium text-accent",children:t.isBreak?"‰ºëÊÅØÊó∂Èó¥":"‰∏ìÊ≥®ÊåëÊàò"})})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-lg font-mono font-bold text-accent",children:Q(t.timeLeft)})})]}),!t.isBreak&&e.jsx("div",{className:"mb-2",children:e.jsx(de,{value:(t.totalTime-t.timeLeft)/t.totalTime*100,className:"h-2"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-accent rounded-full animate-pulse"}),t.isRunning?"‰∏ìÊ≥®‰∏≠":"Â∑≤ÊöÇÂÅú"]}),e.jsxs("div",{className:"flex gap-1",children:[t.isRunning?e.jsx(c,{size:"sm",variant:"outline",onClick:K,className:"h-7 px-2 border-accent/30 text-accent hover:bg-accent/10",children:e.jsx(me,{className:"h-3 w-3"})}):e.jsx(c,{size:"sm",variant:"outline",onClick:A,className:"h-7 px-2 border-primary/30 text-primary hover:bg-primary/10",children:e.jsx(xe,{className:"h-3 w-3"})}),e.jsx(c,{size:"sm",variant:"outline",onClick:M,className:"h-7 px-2 border-destructive/30 text-destructive hover:bg-destructive/10",children:e.jsx(ue,{className:"h-3 w-3"})})]})]})]}),e.jsxs(c,{onClick:()=>L(s.id),className:"w-full h-8 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-medium text-sm",children:[e.jsx(te,{className:"h-3 w-3 mr-1"}),"ÂáªË¥•ÊúÄÁªàBoss - ÂÆåÊàê‰∏ªÁ∫ø"]})]}):e.jsx(c,{onClick:()=>X(s.id),className:"w-full h-9 bg-gradient-to-r from-orange-700 to-red-600 hover:from-orange-800 hover:to-red-700 text-white font-medium shadow-lg border-0",style:{backgroundColor:"#dc2626"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base",children:"‚öîÔ∏è"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-bold text-white",style:{color:"#ffffff",textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:"ÂºÄÂßã‰∏ªÁ∫øÊåëÊàò"}),e.jsx("div",{className:"text-xs font-medium",style:{color:"#fee2e2",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},children:"25ÂàÜÈíüÊåëÊàò"})]})]})})]})]})})},s.id))]}),e.jsxs(se,{value:"habit",className:"space-y-3",children:[e.jsxs("div",{className:"mb-4 p-4 bg-secondary/20 rounded-lg border border-secondary/30",children:[e.jsx("h3",{className:"font-medium text-secondary mb-2",children:"üîÑ ‰π†ÊÉØ (Habits)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ÂèØÈáçÂ§çÂÆåÊàêÔºåÂª∫Á´ãÈïøÊúü‰π†ÊÉØ"})]}),S.filter(s=>!s.completed).length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-foreground px-2",children:["‰ªäÊó•ÂæÖÂÆåÊàê (",S.filter(s=>!s.completed).length,")"]}),S.filter(s=>!s.completed).map(s=>e.jsx(Y,{task:s,onComplete:L,onDelete:_,onStartPomodoro:X,pomodoroState:t,onPausePomodoro:K,onResumePomodoro:A,onResetPomodoro:M,formatTime:Q,userStats:n,skills:R,getIconEmoji:T},s.id))]}),S.filter(s=>s.completed).length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground px-2 border-t border-border pt-4",children:["‰ªäÊó•Â∑≤ÂÆåÊàê (",S.filter(s=>s.completed).length,")"]}),S.filter(s=>s.completed).map(s=>e.jsx(Y,{task:s,onComplete:L,onDelete:_,onStartPomodoro:X,pomodoroState:t,onPausePomodoro:K,onResumePomodoro:A,onResetPomodoro:M,formatTime:Q,userStats:n,skills:R,getIconEmoji:T},s.id))]}),S.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{children:"ËøòÊ≤°Êúâ‰π†ÊÉØ‰ªªÂä°ÔºåÂàõÂª∫‰Ω†ÁöÑÁ¨¨‰∏Ä‰∏™‰π†ÊÉØÂºÄÂßãÂüπÂÖªÂ•Ω‰π†ÊÉØÂêßÔºÅ"})]})]}),e.jsxs(se,{value:"todo",className:"space-y-3",children:[e.jsxs("div",{className:"mb-4 p-4 bg-primary/20 rounded-lg border border-primary/30",children:[e.jsx("h3",{className:"font-medium text-primary mb-2",children:"‚úÖ ÊîØÁ∫ø‰ªªÂä° (Side Quests)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"‰∏ÄÊ¨°ÊÄß‰ªªÂä°ÔºåÂÆåÊàêÂêéÊ∂àÈô§"})]}),D.filter(s=>!s.completed).length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-foreground px-2",children:["Êú™ÂÆåÊàê (",D.filter(s=>!s.completed).length,")"]}),D.filter(s=>!s.completed).map(s=>e.jsx(Y,{task:s,onComplete:L,onDelete:_,onStartPomodoro:X,pomodoroState:t,onPausePomodoro:K,onResumePomodoro:A,onResetPomodoro:M,formatTime:Q,userStats:n,skills:R,getIconEmoji:T},s.id))]}),D.filter(s=>s.completed).length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground px-2 border-t border-border pt-4",children:["Â∑≤ÂÆåÊàê (",D.filter(s=>s.completed).length,")"]}),D.filter(s=>s.completed).map(s=>e.jsx(Y,{task:s,onComplete:L,onDelete:_,onStartPomodoro:X,pomodoroState:t,onPausePomodoro:K,onResumePomodoro:A,onResetPomodoro:M,formatTime:Q,userStats:n,skills:R,getIconEmoji:T},s.id))]}),D.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{children:"ËøòÊ≤°ÊúâÊîØÁ∫ø‰ªªÂä°ÔºåÂàõÂª∫‰Ω†ÁöÑÁ¨¨‰∏Ä‰∏™‰ªªÂä°ÂºÄÂßãÂçáÁ∫ßÂêßÔºÅ"})]})]})]})}),t.taskId&&!I&&e.jsxs("div",{className:`fixed right-4 top-1/2 -translate-y-1/2 text-white rounded-full shadow-xl border-2 border-white cursor-pointer hover:scale-110 transition-all duration-200 group ${t.isRunning?"bg-gradient-to-br from-red-500 to-orange-500":"bg-gradient-to-br from-gray-500 to-gray-600"}`,style:{position:"fixed",right:"16px",top:"50%",transform:"translateY(-50%)",zIndex:999999,width:"80px",height:"80px"},onClick:()=>j(!0),children:[e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:"üçÖ"}),e.jsx("div",{className:"text-xs font-bold leading-tight",children:Q(t.timeLeft)})]}),t.isRunning&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-ping"}),!t.isRunning&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full"}),e.jsxs("div",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 bg-black text-white px-2 py-1 rounded text-xs whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[((re=d.find(s=>s.id===t.taskId))==null?void 0:re.title)||"‰ªªÂä°",t.isRunning?" (ËøõË°å‰∏≠)":" (Â∑≤ÊöÇÂÅú)"]})]}),t.taskId&&I&&e.jsx(pe,{open:!0,onOpenChange:()=>{},children:e.jsxs(ge,{className:"w-[95vw] max-w-4xl h-[95vh] sm:h-[80vh] bg-card border-2 border-primary/30 p-0 overflow-hidden [&>.absolute.right-4.top-4]:!hidden",children:[e.jsxs(be,{className:"sr-only",children:[e.jsx(ye,{children:"Áï™ËåÑÈíüÊåëÊàò"}),e.jsx(je,{children:"Ê≠£Âú®ËøõË°åÁï™ËåÑÈíü‰∏ìÊ≥®Â≠¶‰π†ÔºåÊåëÊàòBoss‰ªªÂä°"})]}),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 sm:p-6 border-b border-border gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ne,{className:"h-5 w-5 sm:h-6 sm:w-6 text-primary"}),e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-foreground truncate",children:((ie=d.find(s=>s.id===t.taskId))==null?void 0:ie.title)||"‰ªªÂä°"})]}),e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4",children:[e.jsxs(u,{variant:"outline",className:"bg-accent/20 text-accent border-accent/30 text-xs",children:[e.jsx(ce,{className:"h-2 w-2 sm:h-3 sm:w-3 mr-1"}),"-",((le=d.find(s=>s.id===t.taskId))==null?void 0:le.requiredEnergyBalls)||1," ËÉΩÈáèÁêÉ"]}),e.jsxs(u,{variant:"outline",className:"bg-primary/20 text-primary border-primary/30 text-xs",children:[e.jsx(W,{className:"h-2 w-2 sm:h-3 sm:w-3 mr-1"}),"+",((ne=d.find(s=>s.id===t.taskId))==null?void 0:ne.expReward)||20," XP"]}),e.jsx(u,{variant:"secondary",className:"bg-secondary/20 text-secondary border-secondary/30 text-xs",children:"‰∏≠Á≠â"}),e.jsx(c,{variant:"ghost",size:"sm",onClick:Te,className:"text-muted-foreground hover:text-foreground",children:e.jsx(Ie,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex-1 p-4 sm:p-8 overflow-y-auto",children:e.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 mb-4",children:[e.jsx("div",{className:"text-2xl sm:text-4xl",children:(()=>{const s=(t.totalTime-t.timeLeft)/t.totalTime*100;return s<25?"‚öîÔ∏è":s<50?"üõ°Ô∏è":s<75?"üíé":"üëë"})()}),e.jsx("h1",{className:"text-xl sm:text-3xl font-bold text-foreground",children:"ÊåëÊàòBoss‰∏≠..."})]}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:(()=>{const s=(t.totalTime-t.timeLeft)/t.totalTime*100;return s<25?"ÂºÄÂßãÊåëÊàòBoss":s<50?"ÊøÄÁÉàÊàòÊñó‰∏≠":s<75?"BossË°ÄÈáèÂëäÊÄ•":"Âç≥Â∞ÜÂáªË¥•Boss"})()})]}),e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("div",{className:"text-4xl sm:text-6xl font-mono font-bold text-primary mb-2",children:Q(t.timeLeft)}),e.jsx("div",{className:"text-sm sm:text-base text-muted-foreground",children:t.isBreak?"üí§ ÂõûÂüé‰ºëÊÅØ":"‚öîÔ∏è ÊàòÊñóÊó∂Èó¥"})]}),e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm text-muted-foreground mb-2",children:[e.jsx("span",{children:"BossË°ÄÈáè"}),e.jsxs("span",{children:[Math.round(100-(t.totalTime-t.timeLeft)/t.totalTime*100),"%"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-4 sm:h-6 border border-red-300 dark:border-red-700",children:e.jsx("div",{className:"bg-gradient-to-r from-red-600 to-red-500 h-4 sm:h-6 rounded-full transition-all duration-1000 flex items-center justify-center text-white text-xs sm:text-sm font-bold drop-shadow-lg",style:{width:`${100-(t.totalTime-t.timeLeft)/t.totalTime*100}%`},children:100-Math.round((t.totalTime-t.timeLeft)/t.totalTime*100)>15&&e.jsx("span",{className:"text-white font-bold drop-shadow-md",children:"DarkBoss"})})})]}),e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm sm:text-base text-muted-foreground mb-4",children:[e.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 bg-primary rounded-full animate-pulse"}),t.isRunning?"Ê≠£Âú®ÊàòÊñóÔºåËØ∑ÂãøÊâìÊâ∞":"ÊàòÊñóÊöÇÂÅú"]})})]})}),e.jsx("div",{className:"p-4 sm:p-6 border-t border-border",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4",children:[t.isRunning?e.jsxs(c,{size:"lg",variant:"outline",onClick:K,className:"w-full sm:w-auto border-accent/30 text-accent hover:bg-accent/10 h-12",children:[e.jsx(me,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),"ÊöÇÂÅúÊàòÊñó"]}):e.jsxs(c,{size:"lg",variant:"outline",onClick:A,className:"w-full sm:w-auto border-primary/30 text-primary hover:bg-primary/10 h-12",children:[e.jsx(xe,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),"ÁªßÁª≠ÊàòÊñó"]}),e.jsxs(c,{size:"lg",variant:"outline",onClick:M,className:"w-full sm:w-auto border-destructive/30 text-destructive hover:bg-destructive/10 h-12",children:[e.jsx(ue,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),"ÈáçÁΩÆÊàòÊñó"]}),e.jsxs(c,{size:"lg",onClick:()=>{t.taskId&&(L(t.taskId),M())},className:"w-full sm:w-auto bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-medium px-4 sm:px-8 h-12",children:[e.jsx(te,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),"ÂáªË¥•Boss"]})]})})]})]})})]})}function Ce({taskId:i}){const[g,m]=h.useState(!1),[E,p]=h.useState([]),[$,T]=h.useState(!1),{toast:t}=he(),B=fe(),I=async()=>{try{T(!0);const d=await(await y("GET",`/api/tasks/${i}/micro-tasks`)).json();if(d.length>0){p(d),m(!0);return}const R=await(await y("POST",`/api/tasks/${i}/generate-micro-tasks`,{})).json();p(R),m(!0)}catch(r){console.error("Error generating micro tasks:",r),t({title:"ÁîüÊàêÂ§±Ë¥•",description:"Êó†Ê≥ïÁîüÊàêÂæÆ‰ªªÂä°ÔºåËØ∑ÈáçËØï",variant:"destructive"})}finally{T(!1)}},j=async r=>{try{await y("PATCH",`/api/micro-tasks/${r}`,{completed:!0}),p(d=>d.map(N=>N.id===r?{...N,completed:!0}:N)),B.invalidateQueries({queryKey:["/api/tasks"]}),t({title:"ÂæÆ‰ªªÂä°ÂÆåÊàê",description:"Ëé∑ÂæóÁªèÈ™åÂ•ñÂä±ÔºÅ"})}catch(d){console.error("Error completing micro task:",d),t({title:"Êõ¥Êñ∞Â§±Ë¥•",description:"Êó†Ê≥ïÊõ¥Êñ∞‰ªªÂä°Áä∂ÊÄÅ",variant:"destructive"})}};return e.jsxs(e.Fragment,{children:[e.jsx(c,{size:"sm",variant:"outline",onClick:I,disabled:$,className:"text-xs px-2 py-1 h-7 bg-blue-500/10 border-blue-500/30 text-blue-600 hover:bg-blue-500/20",children:$?e.jsx("div",{className:"animate-spin w-3 h-3 border border-blue-500 border-t-transparent rounded-full"}):"ÂæÆ‰ªªÂä°"}),e.jsx(pe,{open:g,onOpenChange:m,children:e.jsxs(ge,{className:"max-w-2xl",children:[e.jsxs(be,{children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-blue-500"}),"ÂàÜËß£ÂæÆ‰ªªÂä°"]}),e.jsx(je,{children:"Â∞Ü‰∏ªÁ∫ø‰ªªÂä°ÂàÜËß£‰∏∫Â∞èÊ≠•È™§ÔºåÈÄêÊ≠•ÂÆåÊàêËé∑ÂæóÁªèÈ™åÂ•ñÂä±"})]}),e.jsx("div",{className:"grid gap-3 mt-4",children:E.map(r=>e.jsx(z,{className:`cursor-pointer transition-all ${r.completed?"bg-green-500/10 border-green-500/30":"hover:border-blue-400/50 hover:bg-blue-500/5"}`,onClick:()=>!r.completed&&j(r.id),children:e.jsx(G,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`font-medium text-sm ${r.completed?"text-muted-foreground line-through":"text-foreground"}`,children:r.title}),r.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(we,{className:"h-3 w-3"}),r.duration,"ÂàÜÈíü"]}),e.jsxs("span",{className:"text-blue-600 flex items-center gap-1",children:[e.jsx(W,{className:"h-3 w-3"}),"+",r.expReward," EXP"]}),e.jsx(u,{variant:"outline",className:`text-xs ${r.difficulty==="easy"?"border-green-500/30 text-green-600":r.difficulty==="medium"?"border-yellow-500/30 text-yellow-600":"border-red-500/30 text-red-600"}`,children:r.difficulty==="easy"?"ÁÆÄÂçï":r.difficulty==="medium"?"‰∏≠Á≠â":"Âõ∞Èöæ"})]})]}),r.completed&&e.jsx(ve,{className:"h-5 w-5 text-green-500 flex-shrink-0"})]})})},r.id))}),e.jsx("div",{className:"flex justify-end gap-2 mt-4",children:e.jsx(c,{variant:"outline",onClick:()=>m(!1),children:"ÂÖ≥Èó≠"})})]})})]})}function Ue(){return e.jsx("div",{children:e.jsx(Ke,{})})}export{Ue as default};
